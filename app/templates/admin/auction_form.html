{% extends "layout.html" %}
{% block title %}{% if auction %}Redigera auktion{% else %}Skapa ny auktion{% endif %}{% endblock %}

{% block content %}

    <h1>{% if auction %}Redigera auktion{% else %}Skapa ny auktion{% endif %}</h1>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <ul class="flashes">
            {% for category, message in messages %}
                <li class="{{ category }}">{{ message }}</li>
            {% endfor %}
            </ul>
        {% endif %}
    {% endwith %}

    <form method="post">
        <p><label for="title">Titel:</label><br>
        <input type="text" id="title" name="title" required size="50" value="{{ auction.title if auction }}"></p>

        <p><label for="description">Beskrivning:</label><br>
        <textarea id="description" name="description" required rows="5" cols="50">{{ auction.description if auction }}</textarea></p>

        <p>
            <label for="category">Kategori:</label><br>
            <select id="category" name="category">
                <option value="">-- Välj en kategori --</option>{# all_categories kommer från admin.routes #}
                {% for cat in categories %}
                    <option value="{{ cat }}" {% if auction and auction.category == cat %}selected{% endif %}>{{ cat }}</option>
                {% endfor %}
            </select>
        </p>

        <p><label for="starting_bid">Startbud (SEK):</label><br>
        <input type="number" id="starting_bid" name="starting_bid" required value="{{ auction.starting_bid if auction else 0 }}"></p>

        <p><label for="end_datetime">Slutdatum och tid:</label><br>
        {#-
           Konverterar databasformatet 'YYYY-MM-DD HH:MM:SS' till det format
           som <input type="datetime-local"> förväntar sig: 'YYYY-MM-DDTHH:MM'.
           Vi gör detta genom att ersätta mellanslaget med ett 'T'.
        -#}
        <input type="datetime-local" id="end_datetime" name="end_datetime" required
               value="{{ auction.end_datetime.replace(' ', 'T') if auction and auction.end_datetime else '' }}"></p>

        <button type="submit">{% if auction %}Spara ändringar{% else %}Skapa auktion{% endif %}</button>
    </form>
{% endblock %}